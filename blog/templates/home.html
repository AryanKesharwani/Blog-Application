{% extends "base.html" %}
{% load static %}
{% block title %}Home | MyBlog{% endblock %}

{% block content %}

<!-- Welcome Section -->
{% comment %} <section class="py-5 text-center bg-light border-bottom">
  <div class="container">
    <h1 class="display-5 fw-bold">Welcome to MyBlog</h1>
    <p class="lead text-muted">Discover stories, tutorials, and inspiration from authors around the world.</p>
    <a href="{% url 'post_list' %}" class="btn btn-primary btn-lg mt-3">Explore All Posts</a>
  </div>
</section> {% endcomment %}

<!-- Trending Carousel -->
<section class="mb-5">
  <div id="trendingCarousel" class="carousel slide carousel-fade" data-bs-ride="carousel" style="height: 90vh;">
    <div class="carousel-inner h-100">
      {% for post in trending_posts %}
      <div class="carousel-item {% if forloop.first %}active{% endif %} position-relative h-100">
        <!-- Background Image -->
        <img src="{{ post.image.url }}" class="d-block w-100 h-100 object-fit-cover" alt="{{ post.title }}">

        <!-- Overlay & Content -->
        <div class="position-absolute top-0 start-0 w-100 h-100 d-flex align-items-center justify-content-center px-5" style="background: linear-gradient(to bottom right, rgba(0,0,0,0.6), rgba(0,0,0,0.85)); z-index: 1;">
          <div class="text-white col-lg-6 col-md-8">
            <h1 class="display-4 fw-bold mb-3">{{ post.title }}</h1>
            <p class="lead text-white-75 fw-normal mb-3">{{ post.content|truncatewords:25 }}</p>
            <div class="mb-3">
              <span class="badge bg-warning text-dark me-2">{{ post.category.name }}</span>
              <small class="text-light">By {{ post.author.username }} | {{ post.created_at|date:"M d, Y" }}</small>
            </div>
            <a href="{% url 'post_detail' post.pk %}" class="btn btn-outline-light btn-lg px-4 rounded-pill">Read Full Article</a>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <!-- Controls -->
    <button class="carousel-control-prev" type="button" data-bs-target="#trendingCarousel" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#trendingCarousel" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
    </button>

    <!-- Indicators -->
    <div class="carousel-indicators">
      {% for post in trending_posts %}
      <button type="button" data-bs-target="#trendingCarousel" data-bs-slide-to="{{ forloop.counter0 }}"
        {% if forloop.first %}class="active"{% endif %} aria-label="Slide {{ forloop.counter }}"></button>
      {% endfor %}
    </div>
  </div>
</section>


<!-- Browse Categories Section -->
<section class="my-5">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="fw-bold"><i class="bi bi-tags text-warning"></i> Browse by Categories</h2>
      <p class="text-muted lead">Discover posts by topics you love â€” from tech and travel to lifestyle and learning.</p>
    </div>

    {% if navbar_categories %}
    <div class="row justify-content-center g-3">
      {% for category in navbar_categories %}
      <div class="col-6 col-sm-4 col-md-3 col-lg-2 text-center">
        <a href="{% url 'posts_by_category' category.name %}" class="btn btn-outline-primary w-100 text-truncate shadow-sm">
          <i class="bi bi-folder me-1"></i> {{ category.name }}
        </a>
      </div>
      {% endfor %}
    </div>
    {% else %}
    <div class="text-center text-muted">
      <p>No categories found.</p>
    </div>
    {% endif %}
  </div>
</section>


<hr class="my-5">

<!-- Latest Blog Posts -->
<section class="my-5">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="fw-bold"><i class="bi bi-fire text-danger"></i> Latest Blog Posts</h2>
      <p class="text-muted lead">Stay updated with the newest insights, stories, and trends from our community.</p>
    </div>

    <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
      {% for post in latest_posts %}
      <div class="col">
        <div class="card h-100 shadow-lg border-0 rounded-4 overflow-hidden position-relative post-card-hover">
          {% if post.image %}
          <div class="overflow-hidden">
            <img src="{{ post.image.url }}" class="card-img-top img-fluid post-img" alt="{{ post.title }}">
          </div>
          {% endif %}
          <div class="card-body d-flex flex-column justify-content-between p-4">
            <div>
              <div class="mb-2">
                <span class="badge bg-primary">{{ post.category.name }}</span>
              </div>
              <h5 class="card-title fw-bold">{{ post.title }}</h5>
              <p class="card-text text-muted">{{ post.content|truncatewords:25 }}</p>
            </div>
            <div class="mt-4 d-flex justify-content-between align-items-center">
              <div class="small text-muted">
                <i class="bi bi-person-circle"></i>
                <a href="{% url 'profile' post.author.username %}" class="text-decoration-none">
                  {{ post.author.username }}
                </a><br>
                <i class="bi bi-calendar3"></i> {{ post.created_at|date:"M d, Y" }}
              </div>
              <a href="{% url 'post_detail' post.pk %}" class="btn btn-outline-primary btn-sm rounded-pill">Read More</a>
            </div>
          </div>
        </div>
      </div>
      {% empty %}
      <div class="text-center text-muted">
        <p>No latest posts available.</p>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<hr class="my-5">

<!-- Meet Our Authors -->
<section class="my-5">
  <div class="container">
    <div class="text-center mb-5">
      <h2 class="fw-bold"><i class="bi bi-people text-success"></i> Meet Our Authors</h2>
      <p class="text-muted">A growing team of creative minds sharing stories, experiences, and expertise with the world.</p>
    </div>

    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4">
      {% for user in users %}
      <div class="col">
        <div class="card h-100 border-0 shadow-sm rounded-4 text-center p-4 user-card-clean">
          <img src="{{ user.profile_image.url }}"
               class="rounded-circle mx-auto mb-3"
               style="width: 80px; height: 80px; object-fit: contain;"
               alt="{{ user.username }}">
          
          <h5 class="fw-semibold mb-1">{{ user.username }}</h5>
          <p class="text-muted small mb-1"><i class="bi bi-envelope me-1"></i>{{ user.email }}</p>
          <p class="text-muted small mb-2"><i class="bi bi-calendar-event me-1"></i>Joined: {{ user.date_joined|date:"M d, Y" }}</p>
          
          <span class="badge bg-light text-dark mb-3 px-3 py-1"><i class="bi bi-journal-text me-1"></i>{{ user.posts.count }} Posts</span>
          
          <a href="{% url 'profile' user.username %}" class="btn btn-sm btn-outline-secondary rounded-pill">View Profile</a>
        </div>
      </div>
      {% empty %}
      <div class="text-center text-muted">
        <p>No authors found.</p>
      </div>
      {% endfor %}
    </div>
  </div>
</section>

<!-- Optional Scroll-to-Top Button -->
<button onclick="window.scrollTo({ top: 0, behavior: 'smooth' })"
        class="btn btn-warning shadow rounded-circle position-fixed"
        style="bottom: 20px; right: 20px; z-index: 1050;">
  <i class="bi bi-arrow-up"></i>
</button>

{% endblock %}
